<!DOCTYPE html> 
<html lang="es"> 
<head> 
  <meta charset="UTF-8"> 
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
  <title>JWPlayer Example</title> 
  <!-- Include JWPlayer library --> 
  <script src="https://content.jwplatform.com/libraries/KB5zFt7A.js"></script> 
</head> 
<body> 
  <!-- Create a container for JWPlayer --> 
  <div id="player"></div> 
 
  <script> 
    // Variables - Reemplaza con tus propios valores 
    let token = "eyJ0eXAiOiJKV1QiLCJraWQiOiJ3VTNpZklJYUxPVUFSZVJCL0ZHNmVNMVAxUU09IiwiYWxnIjoiUlMyNTYifQ.eyJhdF9oYXNoIjoibHZvQkZFSkdhTkN4MWJJT2JvVGk3QSIsInN1YiI6InZpZ2lhcGFzQGhvdG1haWwuY29tIiwiYnVzaW5lc3NVbml0IjoiU1NMQS1EVEgiLCJyZWdpb25zIjpbImY5MTdjZmY2LTAyNWEtNDkxNy04NGQ2LWZiNjg2Njk3ZDkzYyIsIjVjM2MxMzUxLWVkMjgtNGNmYS04MDMxLTkxYzhhMTQ5MTJhNSJdLCJhdWRpdFRyYWNraW5nSWQiOiIxZWNlNWMzZi03OTA1LTRkZjYtYWI1Ni01YTBjYmI4NWIwMzYtMzM1Njg4ODkiLCJpc28yQ29kZSI6IkFSIiwiaXNzIjoiaHR0cHM6Ly9wcm9kcm9jay5kaXJlY3R2Z28uY29tOjQ0My9vcGVuYW0vb2F1dGgyL3JlYWxtcy9yb290L3JlYWxtcy9zc2xhIiwidG9rZW5OYW1lIjoiaWRfdG9rZW4iLCJkZXZpY2VJZCI6IlgzQ1U3dWh2RkFRWUhhM0lfQVpGanJVQWd4NFNPNVdTMGhGTkhSbFJlX2MiLCJjdXN0b21lclN0YXR1cyI6IkFjdGl2ZSIsImF6cCI6ImR0dmdvIiwiZmFtaWx5TmFtZSI6IlNBWUVTIiwiYXV0aF90aW1lIjoxNzAxODA1OTA3LCJjdXN0b21lcklkIjoiMjM3MjgxODYiLCJleHAiOjE3MDE5NzE1MTAsImlhdCI6MTcwMTgwNTkxMCwiY3VzdG9tZXJTdGF0dXNNZXNzYWdlIjoiMTAwMSIsImlic0FjY291bnRTdGF0dXMiOiJBQ1RJVkUiLCJnaXZlbk5hbWUiOiJQQUJMTyBBTEVYSSIsInNlcnZpY2VQcm92aWRlckFjY291bnRJZCI6IjU4MGVkZWNmLWVhN2QtNDY2Ni1hNDI5LTQwZmVjY2E3MmM1YiIsInZyaW9EZXZpY2VJZCI6ImRhYmFlY2YwLTAxNTMtNDQzMy04YzhlLWM3MWFjZTdlNGFlOCIsImF1ZCI6ImR0dmdvIiwiY2hhbm5lbHMiOlsiQ0gwMTAwMDAwMDAwMDE5IiwiQ0gwMTAwMDAwMDAwMTY3IiwiQ0gwMTAwMDAwMDAwMDc2IiwiQ0gwMTAwMDAwMDAwMTA3IiwiQ0gwMTAwMDAwMDAwMjAyIiwiQ0gwMTAwMDAwMDAwMDI2IiwiQ0gwMTAwMDAwMDAwMTY5IiwiQ0gwMTAwMDAwMDAwMTUxIiwiQ0gwMTAwMDAwMDAwMjE2IiwiQ0gwMTAwMDAwMDAwMjA5IiwiQ0gwMTAwMDAwMDAwMDc1IiwiQ0gwMTAwMDAwMDAwMjk1IiwiQ0gwMTAwMDAwMDAwMjkzIiwiQ0gwMTAwMDAwMDAwMDM5IiwiQ0gwMTAwMDAwMDAwMDg3IiwiQ0gwMTAwMDAwMDAwMjI5IiwiQ0gwMTAwMDAwMDAwMDE4IiwiQ0gwMTAwMDAwMDAwMDY4IiwiQ0gwMTAwMDAwMDAwMDM4IiwiQ0gwMTAwMDAwMDAwMDIwIiwiQ0gwMTAwMDAwMDAwMDE1IiwiQ0gwMTAwMDAwMDAwMTQyIiwiQ0gwMTAwMDAwMDAwMTQwIiwiQ0gwMTAwMDAwMDAwMTcxIiwiQ0gwMTAwMDAwMDAwMTE3IiwiQ0gwMTAwMDAwMDAwMDY1IiwiQ0gwMTAwMDAwMDAwMDQ2IiwiQ0gwMTAwMDAwMDAwMjM1IiwiQ0gwMTAwMDAwMDAwMjg2IiwiQ0gwMTAwMDAwMDAwMjMwIiwiQ0gwMTAwMDAwMDAwMjkyIiwiQ0gwMTAwMDAwMDAwMTM5IiwiQ0gwMTAwMDAwMDAwMjAzIiwiQ0gwMTAwMDAwMDAwMDUwIiwiQ0gwMTAwMDAwMDAwMDc0IiwiQ0gwMTAwMDAwMDAwMTE4IiwiQ0gwMTAwMDAwMDAwMTYxIiwiQ0gwMTAwMDAwMDAwMjcxIiwiQ0gwMTAwMDAwMDAwMDgwIiwiQ0gwMTAwMDAwMDAwMDY0IiwiQ0gwMTAwMDAwMDAwMDg2IiwiQ0gwMTAwMDAwMDAwMTQ4IiwiQ0gwMTAwMDAwMDAwMjE1IiwiQ0gwMTAwMDAwMDAwMjIzIiwiQ0gwMTAwMDAwMDAwMjQ3IiwiQ0gwMTAwMDAwMDAwMjU5IiwiQ0gwMTAwMDAwMDAwMTI4IiwiQ0gwMTAwMDAwMDAwMDM3IiwiQ0gwMTAwMDAwMDAwMjY4IiwiQ0gwMTAwMDAwMDAwMjM2IiwiQ0gwMTAwMDAwMDAwMTQ2IiwiQ0gwMTAwMDAwMDAwMTE1IiwiQ0gwMTAwMDAwMDAwMDMxIiwiQ0gwMTAwMDAwMDAwMTk0IiwiQ0gwMTAwMDAwMDAwMjY5IiwiQ0gwMTAwMDAwMDAwMjYzIiwiQ0gwMTAwMDAwMDAwMDk4IiwiQ0gwMTAwMDAwMDAwMjA3IiwiQ0gwMTAwMDAwMDAwMDUzIiwiQ0gwMTAwMDAwMDAwMDQ0IiwiQ0gwMTAwMDAwMDAwMjcwIiwiQ0gwMTAwMDAwMDAwMjY3IiwiQ0gwMTAwMDAwMDAwMDUyIiwiQ0gwMTAwMDAwMDAwMjIyIiwiQ0gwMTAwMDAwMDAwMjM5IiwiQ0gwMTAwMDAwMDAwMDg1IiwiQ0gwMTAwMDAwMDAwMTkzIiwiQ0gwMTAwMDAwMDAwMDkyIiwiQ0gwMTAwMDAwMDAwMTA2IiwiQ0gwMTAwMDAwMDAwMTExIiwiQ0gwMTAwMDAwMDAwMTEyIiwiQ0gwMTAwMDAwMDAwMTE5IiwiQ0gwMTAwMDAwMDAwMzAyIiwiQ0gwMTAwMDAwMDAwMTQxIiwiQ0gwMTAwMDAwMDAwMjgxIiwiQ0gwMTAwMDAwMDAwMTM0IiwiQ0gwMTAwMDAwMDAwMTM2IiwiQ0gwMTAwMDAwMDAwMjgzIiwiQ0gwMTAwMDAwMDAwMjk4IiwiQ0gwMTAwMDAwMDAwMjA4IiwiQ0gwMTAwMDAwMDAwMjI2IiwiQ0gwMTAwMDAwMDAwMjczIiwiQ0gwMTAwMDAwMDAwMjc2IiwiQ0gwMTAwMDAwMDAwMzEyIiwiQ0gwMTAwMDAwMDAwMzE1IiwiQ0gwMTAwMDAwMDAwMzE2IiwiQ0gwMTAwMDAwMDAwMzE3IiwiQ0gwMTAwMDAwMDAwMzMxIiwiQ0gwMTAwMDAwMDAwMzM0IiwiQ0gwMTAwMDAwMDAwMzM3Il0sInZyaW9DdXN0b21lcklkIjoiNTgwZWRlY2YtZWE3ZC00NjY2LWE0MjktNDBmZWNjYTcyYzViIiwibmFtZSI6IlBBQkxPIEFMRVhJIFNBWUVTIiwicmVhbG0iOiIvc3NsYSIsImNzbSI6IjIiLCJ0b2tlblR5cGUiOiJKV1RUb2tlbiJ9.hFq31yudXYjNgF9RWQIAN8g2jnJpdH1jMkL0efiGzn7DU0oC0ai2V_Mo3LquhGEPLs0XWbukSiXCeZgDtzKMAO8VG1IVgDPfcUmYukhMyWyRtB-DJbhlglDQwcUELNLqHLfRRemYZIMMww_EaY9094httI6U6rS6bZ6utD-CPF0BiC97motrxrqVcLW8zhjVCQrUjQigi9Yh7weWNMugj7MUTya5PeYiiUJAMe8pFOkWhiqzbxta1jzflNzvpKzG-nzIPp0_DuQisEX3XzCcuhgihl66A4-lYSSGUn9TmkUwKBaXiGT6UJriIGZ4TioMO4UQsrE3O1mX-F_ZcRqa5A"; 
    let chid = "CH0100000000134"; 
    let keyId = "d677a19db3a05a019d8683b9250cbc0f"; 
    let key = "5012fa90476d714171f077af80a70218"; 
 
    // Obtener el token de autorización 
    fetch("https://api.directvgo.com/entitlement/v3/playback/token/authorizer", { 
      method: "POST", 
      headers: { 
        "Authorization": "Bearer " + token, 
        "Content-Type": "application/json", 
        "X-Client-Id": "web", 
        "X-Client-Version": "3.17.0" 
      }, 
      body: JSON.stringify({ 
        contentId: chid, 
        delay: 0, 
        isLive: true, 
        mobileNetwork: true 
      }) 
    }) 
      .then(response => response.json()) 
      .then(data => { 
        if (data.manifest && data.manifest.dash && data.manifest.dash.primary) { 
          let manifestUrl = data.manifest.dash.primary; 
 
          // Realizar solicitud para obtener hdntl 
          fetch(manifestUrl) 
            .then(response => { 
              if (!response.ok) { 
                throw new Error('HTTP error! status: ' + response.status); 
              } 
              const hdntl = response.headers.get('hdntl'); 
              if (hdntl) { 
                // hdntl está disponible, puedes usarlo según sea necesario 
                console.log('hdntl:', hdntl); 
 
                // Configurar JWPlayer con clearkey y hdntl 
                let player = jwplayer("player"); 
                player.setup({ 
                  playlist: [{ 
                    sources: [{ 
                      default: false, 
                      type: "dash", 
                      file: manifestUrl, 
                      drm: { 
                        clearkey: { 
                          keyId: keyId, 
                          key: key 
                        } 
                      }, 
                      label: "0", 
                      // Agregar encabezado "Hdntl" a la solicitud de audio 
                      onXhrOpen: function (xhr, url) { 
                        if (!url.includes("manifest.mpd")) { 
                          xhr.setRequestHeader("Hdntl", hdntl); 
                        } 
                      } 
                    }] 
                  }], 
                  width: "100%", 
                  height: "100%", 
                  aspectratio: "16:9", 
                  autostart: true, 
                  cast: {}, 
                  sharing: false 
                }); 
              } else { 
                console.log('Header "hdntl" not found in the response.'); 
              } 
              return response.text(); 
            }) 
            .catch(error => console.error('Error fetching MPD:', error)); 
 
        } else { 
          console.error("Dash primary URL not found in the response."); 
        } 
      }) 
      .catch(error => console.error("Error fetching authorization token:", error)); 
  </script> 
</body> 
</html>
